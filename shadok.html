<!doctype html>
<html>
<head>
<meta charset="utf-8">
	  
	  <script language="Javascript">    
<!--    
//******************************* classe Shadok***********************************
	//function constructeur d'objet shadok
	function ClasseShadok(xx,yy,coul){
		// création des variables
		this.x = xx;
		this.y =yy
		this.couleur = coul;
		this.ouverture = 0;
		this.sens= 1;
		this.mouvement =1;
		this.min = 0;
		this.max = 8;
	    // déclaration de la fonction dessiner 
		this.dessiner = function(context){			
			
			// on dessine le shadok
			context.fillStyle = this.couleur; 
			context.beginPath();
			context.arc(this.x, this.y, 20, Math.PI*0.45,  Math.PI*1.55);			
			context.lineTo(this.x+30,this.y-this.ouverture*2);
			context.lineTo(this.x,this.y);
			context.lineTo(this.x+30,this.y+this.ouverture*2);
			context.closePath();
			context.fill();	 
		}
		this.claquerDesDents = function(){
			this.ouverture=this.ouverture +(this.mouvement * this.sens);
			if( this.ouverture>=this.max)
			{
				this.ouverture=this.max;
				this.sens =-1;
			}
			if( this.ouverture<=this.min)
			{
				this.ouverture=this.min;
				this.sens =1;
			}
		}
		
		
	}// ---------------------- fin classe Shadok
	
	//*********************************** classe capteur **************************
    //function constructeur d'objet capteur
	function ClasseCapteur(x,y,h,t){
        // création des variables
		this.x = x;
		this.y =y;
		//this.couleur = coul;
	    this.h = h;
		largeur =50;
		this.t = t;
	    // déclaration de la fonction dessiner 
		this.dessiner = function(context){			
			
			// on dessine le capteur 
			context.fillStyle = "#000"; 
			context.beginPath();
			context.rect(this.x,this.y,largeur,this.h);			
			context.strokeText("T°:",355,180);
			context.closePath();
			context.fill();	 
		}


     }

	
	//******************************* classe Pompe***********************************
	//function constructeur d'objet pompe
	function ClassePompe(xx,yy,r,ang,marche){
		// création des variables
		this.x = xx;
		this.y = yy;
		this.r = r;
		this.ang = ang;
		this.marche = marche;
		
		
		
		
		
		
	    // déclaration de la fonction dessiner 
		this.dessiner = function(context){			
			
			// on dessine le shadok
			context.fillStyle = "#000000" 
			context.beginPath();
			context.arc(this.x, this.y, this.r, -0.5+this.ang,  0.5+this.ang);
			context.lineTo(this.x,this.y);		
			context.arc(this.x, this.y, this.r, Math.PI-0.5+this.ang,  Math.PI+0.5+this.ang);	
			context.lineTo(this.x,this.y);
			context.closePath();
			context.fill();	 
		}
	
	this.tourner = function ()
		{
			if (this.marche ==1){
				this.ang= this.ang + 0.3;
				
			}
			
			}
		
	}// ---------------------- fin classe Shadok

//*********************************** classe simulateur **************************
	// function constructeur d'objet simulateur
	function ClasseSimulateur(){
		// intanciation des 2 shadoks (shad1 et shad2)
		this.shad1 = new ClasseShadok(50,60,"#0000ff");		
		this.shad2 = new ClasseShadok(100,80,"#ff0000");
		this.pompe = new ClassePompe(150,200,25,7,1);
		this.capteur = new ClasseCapteur(300,100,150,100);
		
		this.dessiner = function(context){
			// on régénère l'arière plan			
			context.rect(0,0,400,300);
			context.fillStyle = "#ffff00"; 
			context.fill();
			//on appelle la methode dessiner de l'objet shad (de type shadok)
			this.shad1.dessiner(context);
			this.shad2.dessiner(context);
			this.pompe.dessiner(context);
			this.capteur.dessiner(context);
		}
		
		
			
	}
//------------------------------fin de la classe simulateur --------------------------------


window.onload = function()
{   
	//*************************** zoe de définition des fonctions **************
	

	
	function arreter(){
	    sim.shad1.mouvement=0;	
		sim.pompe.marche=0;	
	}	
	function relancer(){
		sim.shad1.mouvement=1;
		sim.pompe.marche=1;
	}	
	
  // la fonction évoluer n'est pas appelé immédiatement lors du chargement mais seulement par le timer	
  
  function evoluer()
    {    
        // la fonction evoluer demande aux 2 shados de claquer des dents
        sim.shad1.claquerDesDents();
        sim.shad2.claquerDesDents();
        // puis demande au simulateur de se dessiner
        sim.dessiner(context);
        // puis affiche le sens de deplacement du shad1
		document.monForm.ouverture.value =sim.shad1.sens;
		sim.pompe.tourner();
		
    }
  //******************* fin definition des fonctions**************  
  //************************************************************** 
  //	debutdu code exécuté au chargement de la page
  //**************************************************************
  
  var monCanevas = document.getElementById("canvasId");
  // tout est mis dans un if getContext de monCanevas afin d'éviter les plantage si canvas n'est pas géré par le navigateur
  if (monCanevas.getContext){

    var context= monCanevas.getContext("2d"); 
 
     
    // instancie(construit) un jeu  nommé  j
    var sim = new ClasseSimulateur();
    
    
    // definition du timer en ms et de la fonction appellée par le timer
    // ATTENTION : pas de parenthèses pour la fonction appelée
    // le jeu est redessiné toutes les 30 ms
    var myInterval = setInterval(evoluer, 50);
    // gestionnaire d'événement
    document.monForm.boutonStop.onclick=arreter;
    document.monForm.boutonEncore.onclick=relancer;
  }     // fin de   if (monCanevas.getContext)
   
}    //   fin de window.onload = function()



-->    
</script>
</head>
<body>
  <p> le canvas : permet de visualiser shad1 et shad2,  nos  2 Shadoks en temps réel </p>
  <canvas id="canvasId" width="400" height="300" name="monCanevas">
	  Texte si navigateur ne supporte pas la balise Canvas
  </canvas>
  <p>Ci-après Un formulaire pour réaliser un IHM simple</p>
  <form name="monForm">	  
      sens: <input value="0" name="ouverture" id="ouverture" type="text"><br> 
      <input value="Stop" name="boutonStop" type="button" >     
      <input value="Encore" name="boutonEncore" type="button" >  
  </form>

</html>
